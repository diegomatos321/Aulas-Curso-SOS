<!DOCTYPE html><html lang="pt_br"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1, user-scalable=0" /><meta name="apple-mobile-web-app-capable" content="yes" /><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" /><meta http-equiv="X-UA-Compatible" content="ie=edge"><style type="text/css">body{margin:0;padding:0}canvas{image-rendering:crisp-edges;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;-ms-interpolation-mode:nearest-neighbor;position:absolute}#background-layer{z-index:0;background:#5c94fc}#pipeSouth-layer{z-index:1}#ground-layer{z-index:2}#game-layer{z-index:3}#hud-layer{z-index:4}</style><title>Flappy Bird</title></head><body><div id="loading-txt"></div><div id="GameScreen"> <canvas id="hud-layer"></canvas> <canvas id="game-layer"></canvas> <canvas id="ground-layer"></canvas> <canvas id="pipeSouth-layer"></canvas> <canvas id="background-layer"></canvas></div> <script>class Vector{constructor(t,s){this._x=t,this._y=s}setX(t){this._x=t}setY(t){this._y=t}setXY(t,s){this._x=t,this._y=s}getX(){return this._x}getY(){return this._y}setAngle(t){let s=this.getLength();this._x=Math.cos(t)*s,this._y=Math.sin(t)*s}getAngle(){return Math.atan2(this._y,this._x)}setLength(t){let s=this.getAngle();this._x=Math.cos(s)*t,this._y=Math.sin(s)*t}getLength(){return Math.sqrt(this._x**2+this._y**2)}add(t){return new Vector(this._x+t.getX(),this._y+t.getY())}addTo(t){this._x+=t.getX(),this._y+=t.getY()}subtract(t){return new Vector(this._x-t.getX(),this._y-t.getY())}subtractBy(t){this._x-=t.getX(),this._y-=t.getY()}multiply(t){return new Vector(this._x*t,this._y*t)}multiplyBy(t){this._x*=t,this._y*=t}}</script> <script>!function(){window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)};let t=[window.document.getElementById("background-layer"),window.document.getElementById("pipeSouth-layer"),window.document.getElementById("ground-layer"),window.document.getElementById("game-layer"),window.document.getElementById("hud-layer")],e=[t[0].getContext("2d"),t[1].getContext("2d"),t[2].getContext("2d"),t[3].getContext("2d"),t[4].getContext("2d")],i=window.document.getElementById("GameScreen"),n=320,s=480,a=0,o=0,r=0,h=!1,g=!1;const d=new Vector(0,1400);let m=void 0,l=void 0,c=new Array,p=(new Array,0),u=0,w=0,A=0,E=0,T=document.getElementById("loading-txt"),f={imagens:{},audio:{},CarregarImagem:function(t,e,i){console.log(`Carregando: ${t} (${A}/${w}) `),T.textContent=`Carregando: ${t} (${A}/${w}) `,f.imagens[t]=new Image,f.imagens[t].addEventListener("load",function(){A++,console.log(`CARREGADO: ${t} (${A}/${w}) `),T.textContent=`CARREGADO: ${t} (${A}/${w}) `,A==w&&i()}),f.imagens[t].src=e},CarregarAudio:function(t,e){A++,f.audio[t]=new Audio,f.audio[t].src=e,console.log(`CARREGADO: ${t} (${A}/${w}) `),T.textContent=`CARREGADO: ${t} (${A}/${w}) `}};class y{constructor(t,e,i,n,s,a){this.name=a,this.image=f.imagens[t],this.width=n||f.imagens[t].width,this.height=s||f.imagens[t].height,this.velocity=new Vector(0,0),this.position=new Vector(e,i),this.active=!0,this.anims={isPlaying:!1}}draw(){this.anims.isPlaying?e[3].drawImage(this.image,this.anims.current.originX,this.anims.current.originY,this.width,this.height,this.position.getX(),this.position.getY(),this.width,this.height):this.anims.isPlaying||e[3].drawImage(this.image,this.position.getX(),this.position.getY(),this.width,this.height)}update(t){this.anims.isPlaying&&this.processAnimation(t)}setSpriteSheetConfig(t,e){this.anims.config={frameWidth:t,frameHeight:e,rowNumber:Math.round(this.image.height/e),columnNumber:Math.round(this.image.width/t)}}addAnimation(t,e,i){this.anims[t]={frames:e,originX:0,originY:0,currentTime:0,currentFrame:e[0],delay:i}}playAnimation(t){this.anims.current=this.anims[t],this.anims.isPlaying=!0}processAnimation(t){if(this.anims.current.currentTime+=1e3*t,this.anims.current.currentTime<this.anims.current.delay)return;let e=this.anims.current.frames,i=this.anims.current.currentFrame,n=this.anims.config.rowNumber,s=this.anims.config.columnNumber,a=!1;-1==e.indexOf(i)&&(i=e[0],this.anims.current.currentFrame=e[0]);let o=0;for(let t=0;t<s&&!a;t++)for(let s=0;s<n;s++){if(o==i&&-1!=e.indexOf(i)){this.anims.current.originY=s*this.anims.config.frameHeight,this.anims.current.originX=t*this.anims.config.frameWidth,this.anims.current.currentFrame++,this.anims.current.currentTime=0,a=!0;break}o++}}}let S={Bird:class extends y{constructor(t){super(t.sprite,t.x,t.y,t.width,t.height,t.name),this.GAME_STATE=N.STATE.MENU,this.angle=0,this.ANGULAR_VELOCITY=45,this.FORCE_JUMP=new Vector(0,-350)}draw(){e[3].save(),e[3].translate(this.position.getX()+this.width/2,this.position.getY()+this.height/2),e[3].rotate(this.angle),this.anims.isPlaying?e[3].drawImage(this.image,this.anims.current.originX,this.anims.current.originY,this.width,this.height,-this.width/2,-this.height/2,this.width,this.height):this.anims.isPlaying||e[3].drawImage(this.image,-this.width/2,-this.height/2,this.width,this.height),e[3].restore()}update(t){this.GAME_STATE==N.STATE.RUNNING&&(this.velocity.addTo(d.multiply(t)),(this.angle<Math.PI/180*20||this.angle>=Math.PI/180*340)&&this.addAngle(Math.PI/180*this.ANGULAR_VELOCITY*t),this.position.addTo(this.velocity.multiply(t)),(this.position.getY()+this.height>=s||this.position.getY()<=0)&&I(),this.anims.isPlaying&&this.processAnimation(t))}addAngle(t){this.angle+=t}setAngle(t){this.angle=t}moveUp(){if(this.GAME_STATE!=N.STATE.RUNNING)return;this.velocity.setY(this.FORCE_JUMP.getY()),this.setAngle(Math.PI/180*340),S.get("Audio","fly_music",{name:"fly_music"}).play()}reset(){this.angle=0,this.velocity.setLength(0),this.position.setXY(n/10-17,s/4)}},Background:class{constructor(t){this.name=t.name,this.imagens=[f.imagens.chao,f.imagens.background],this.velocity=[new Vector(-100,0),new Vector(-10,0)],this.active=!0,this.positions=[new Vector(t.x,t.y+382),new Vector(t.x,t.y+273),new Vector(t.x+this.imagens[0].width,t.y+382),new Vector(t.x+this.imagens[1].width,t.y+273)]}draw(){this.positions.forEach((t,i)=>{let n=i%2;0==n?e[2].drawImage(this.imagens[0],t.getX(),t.getY()):1==n&&e[0].drawImage(this.imagens[1],t.getX(),t.getY())})}update(t){m.GAME_STATE==N.STATE.RUNNING&&this.positions.forEach((e,i)=>{let n=i%2;0==n?e.getX()+this.imagens[0].width<0&&(0==i?e.setX(this.positions[2].getX()+this.imagens[0].width):2==i&&e.setX(this.positions[0].getX()+this.imagens[0].width)):1==n&&e.getX()+this.imagens[1].width<0&&(1==i?e.setX(this.positions[3].getX()+this.imagens[1].width):3==i&&e.setX(this.positions[1].getX()+this.imagens[1].width)),e.addTo(this.velocity[n].multiply(t))})}},Pipe:class extends y{constructor(t){super(t.sprite,t.x,t.y,t.width,t.height,t.name),this.velocity=new Vector(-100,0)}draw(){"Pipe North"==this.name?e[3].drawImage(this.image,this.position.getX(),this.position.getY()):"Pipe South"==this.name&&e[1].drawImage(this.image,this.position.getX(),this.position.getY())}update(t){m.GAME_STATE==N.STATE.RUNNING&&(this.position.addTo(this.velocity.multiply(t)),this.position.getX()+this.image.width<0&&(this.active=!1),"Pipe North"==this.name&&m.position.getX()>=this.position.getX()+this.image.width&&m.position.getX()<=this.position.getX()+this.image.width+-this.velocity.getX()*t&&function(){let t=S.get("Audio","score_music",{name:"score_music"});t.volume=.5,t.play(),p++}())}resetAt(t){this.position.setX(t.x),this.position.setY(t.y),this.active=!0}},Coin:class extends y{constructor(t){super(t.sprite,t.x,t.y,t.width,t.height,t.name)}},stored:new Array,get:function(t,e,i){let n=-1;for(let t=0;t<this.stored.length;t++){if(this.stored[t].name==e){n=t;break}}if(n>=0){let t=this.stored[n];return this.stored.splice(n,1),t.resetAt(i),t}return this.create(t,i)},create:function(t,e){let i;return"Audio"==t?((i=f.audio[e.name].cloneNode(!0)).name=e.name,i.resetAt=function(t){this.src=f.audio[t.name].src},i.addEventListener("ended",t=>{S.add(t.path[0])})):i=new this[t](e),i},add:function(t){t.length>0?t.forEach(t=>{this.stored.push(t)}):this.stored.push(t)}},N={STATE:{RUNNING:0,MENU:1,PAUSED:2,GAME_OVER:3},init:function(){userAgent=navigator.userAgent.toLocaleLowerCase(),h=userAgent.indexOf("android")>-1,g=userAgent.indexOf("iphone")>-1||userAgent.indexOf("ipad")>-1,t.forEach(t=>{t.width=n,t.height=s}),a=n/s,Display.resize();let e=[["background","./assets/imagens/Background.webp"],["chao","./assets/imagens/Floor.webp"],["pipeNorth_img","./assets/imagens/PipeNorth.webp"],["pipeSouth_img","./assets/imagens/PipeSouth.webp"],["bird_sprite","./assets/imagens/BirdSprite.webp"],["coin_sprite","./assets/imagens/CoinSprite.webp"],["enter_btn","./assets/imagens/Enter_btn.webp"],["gameOverScreen","./assets/imagens/GameOverScreen.webp"],["startMenuScreen","./assets/imagens/StartMenu.webp"]],i=[["fly_music","./assets/sounds/fly.mp3"],["score_music","./assets/sounds/score.mp3"]];w+=e.length,w+=i.length,e=new Map(e),i=new Map(i),e.forEach((t,e)=>{f.CarregarImagem(e,t,N.start)}),i.forEach((t,e)=>{f.CarregarAudio(e,t,N.start)})},start:function(){window.document.body.removeChild(T),(u=window.localStorage.getItem("javascript-flappy-bird-storage"))||(window.localStorage.setItem("javascript-flappy-bird-storage","0"),u=0),(m=S.get("Bird","Bird",{sprite:"bird_sprite",x:n/10-17,y:s/4,width:34,height:22.333,name:"Bird"})).setSpriteSheetConfig(34,67/3),m.addAnimation("Voo",[0,1,2],80),m.playAnimation("Voo"),l=S.get("Background","Background",{x:0,y:0,name:"Background"}),Display.drawHUD(N.STATE.MENU,0),h||g?(i.addEventListener("touchstart",_,{passive:!1}),i.addEventListener("touchmove",null,{passive:!1}),i.addEventListener("touchend",null,{passive:!1}),i.addEventListener("touchcancel",null,{passive:!1})):i.addEventListener("click",_,{passive:!1}),window.setInterval(x,1600),requestAnimFrame(N.Engine.GameLoop)},Engine:{GameLoop:function(t){requestAnimFrame(N.Engine.GameLoop),t/=1e3,deltaTime=t-E,E=t,N.Engine.update(),Display.render()},update:function(){l.update(deltaTime),m.update(deltaTime),m.position.getY()+m.height>=382&&I();let t=c.filter(t=>0==t.active);t.length>0&&S.add(t),(c=c.filter(t=>1==t.active)).forEach(t=>{t.update(deltaTime);let e=t.position.getX()-(m.position.getX()+m.width);e<=200*deltaTime&&e>=-(t.image.width+m.width)&&m.position.getX()+m.width>=t.position.getX()&&m.position.getX()<=t.position.getX()+t.image.width&&m.position.getY()<=t.position.getY()+t.image.height&&m.position.getY()+m.height>=t.position.getY()&&I()})}}};function x(){if(m.GAME_STATE!=N.STATE.RUNNING)return;newPosY=Math.round(-233*Math.random()),GAP=f.imagens.pipeNorth_img.height+100;let t=S.get("Pipe","Pipe North",{sprite:"pipeNorth_img",x:n,y:newPosY,name:"Pipe North"}),e=S.get("Pipe","Pipe South",{sprite:"pipeSouth_img",x:n,y:newPosY+GAP,name:"Pipe South"});c.push(t),c.push(e)}function v(){if(m.GAME_STATE==N.STATE.MENU||m.GAME_STATE==N.STATE.GAME_OVER){e[4].clearRect(0,0,n,s),m.reset(),p=0;let t=c.filter(t=>"Pipe North"==t.name||"Pipe South");t.length>0&&S.add(t),c.length=0,m.GAME_STATE=N.STATE.RUNNING}}function _(t){if(m.GAME_STATE==N.STATE.RUNNING)m.moveUp();else if(m.GAME_STATE==N.STATE.MENU)v();else if(m.GAME_STATE==N.STATE.GAME_OVER){let e=f.imagens.enter_btn.width*o/n,i=f.imagens.enter_btn.height*r/s,a=o/2-e/2,h=r/3-i/2+100*r/s,g=t.x||t.touches[0].pageX,d=t.y||t.touches[0].pageY;g>=a&&g<=a+e&&d>=h&&d<=h+i&&v()}}function I(){p>u&&(u=p,window.localStorage.setItem("javascript-flappy-bird-storage",u)),m.GAME_STATE=N.STATE.GAME_OVER,Display.drawHUD(N.STATE.GAME_OVER,0)}Display={render:function(){e.forEach((t,e)=>{4!=e&&t.clearRect(0,0,n,s)}),l.draw(),m.draw(),c.forEach(t=>{t.draw()}),m.GAME_STATE==N.STATE.RUNNING&&(e[4].clearRect(0,0,n,s),Display.drawHUD(N.STATE.RUNNING,deltaTime))},drawHUD:function(t,i){t==N.STATE.MENU&&(e[4].drawImage(f.imagens.startMenuScreen,n/2-f.imagens.startMenuScreen.width/2,s/3-f.imagens.startMenuScreen.height/2),e[4].font="24px Source Code Pro",e[4].textAlign="center",e[4].fillStyle="white",e[4].fillText("Clone do Flappy Bird",n/2,s-48),e[4].fillText("Por Diego Matos",n/2,s-24)),t==N.STATE.PAUSED&&(e[4].fillStyle="rgba(0, 0, 0, 0.5)",e[4].fillRect(0,0,n,s),e[4].font="26px Arial",e[4].textAlign="center",e[4].fillStyle="white",e[4].fillText("PAUSADO",n/2,s/2)),t==N.STATE.GAME_OVER&&(e[4].drawImage(f.imagens.gameOverScreen,n/2-f.imagens.gameOverScreen.width/2,s/3-f.imagens.gameOverScreen.height/2),e[4].drawImage(f.imagens.enter_btn,n/2-f.imagens.enter_btn.width/2,s/3-f.imagens.enter_btn.height/2+100),p<50?e[4].drawImage(f.imagens.coin_sprite,46,45,46,45,72,166,46,45):p<100?e[4].drawImage(f.imagens.coin_sprite,46,0,46,45,72,166,46,45):e[4].drawImage(f.imagens.coin_sprite,0,45,46,45,72,166,46,45),e[4].font="14px Arial",e[4].fillStyle="black",e[4].textAlign="center",e[4].fillText(`${p}`,230,170),e[4].font="14px Arial",e[4].textAlign="center",e[4].fillText(`${u}`,232,210)),t==N.STATE.RUNNING&&(e[4].font="24px Arial",e[4].fillStyle="black",e[4].textAlign="left",e[4].fillText(`${p}`,20,30),e[4].font="14px Arial",e[4].fillStyle="black",e[4].textAlign="right",FPS=1e3/(1e3*i),e[4].fillText(`FPS: ${FPS.toFixed(2)}`,n,14))},resize:function(){a=h||g?window.innerHeight>window.innerWidth?window.innerWidth/window.innerHeight:window.innerHeight/window.innerWidth:n/s,r=window.innerHeight,o=r*a,t.forEach(t=>{t.style.width=o+"px",t.style.height=r+"px"})}},window.addEventListener("load",N.init,!1),window.addEventListener("resize",Display.resize,!1)}();</script> </body></html>